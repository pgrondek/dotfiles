#!/usr/bin/env bash

if [[ "$DESKTOP_SESSION" = "dwm" ]]; then
    export _JAVA_AWT_WM_NONREPARENTING=1
    export AWT_TOOLKIT=MToolkit
    wmname LG3D

    compton &
    redshift &
    dwmstatus &
    dunst &
    numlockx on &

    if command -v blueman-applet &> /dev/null ; then
       blueman-applet &
    fi

    # Audio
    if command -v pasystray &> /dev/null ; then
        pasystray &
    fi

    if command -v nextcloud &> /dev/null ; then
        nextcloud &
    fi
    
    if command -v signal-desktop &> /dev/null ; then
        signal-desktop --start-in-tray &
    fi

    # Bluetooth 
    if command -v jetbrains-toolbox &> /dev/null ; then
        jetbrains-toolbox --minimize &
    fi

    # Authentication agent for running application as root
    if test /usr/lib/policykit-1-gnome/polkit-gnome-authentication-agent-1 ; then
        /usr/lib/policykit-1-gnome/polkit-gnome-authentication-agent-1 &
    fi

    # Set background
    if test -f /usr/share/backgrounds/brad-huchteman-stone-mountain.jpg ; then
          feh --bg-scale /usr/share/backgrounds/brad-huchteman-stone-mountain.jpg &
    else
        if test -f /usr/share/backgrounds/gnome/Road.jpg ; then
          feh --bg-scale /usr/share/backgrounds/gnome/Road.jpg &
        fi
    fi
fi


